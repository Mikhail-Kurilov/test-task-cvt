{"ast":null,"code":"class GameDrPill {\n  constructor({\n    id,\n    callbacks\n  }) {\n    this.canvas = document.getElementById(id);\n    this.context = this.canvas.getContext('2d');\n    this.canvas.width = 560;\n    this.canvas.height = 560;\n    this.canvas.addEventListener('click', event => this.clickCell(event));\n    this.ADD_PILLS = 10;\n    this.FIELD_SIZE = 8;\n    this.ROUND_TIME = 60; // sec\n\n    this.SIZE = 70;\n    this.callbacks = callbacks;\n    this.field = [];\n    this.sec = 0;\n    this.interval = null;\n    this.currentPills = 0;\n    this.requirePills = 20;\n    this.vaccineScore = 0;\n    this.firstStep = true;\n    this.x = -1;\n    this.y = -1;\n    this.pills = [null];\n    this.pills.push(new Image());\n    this.pills[1].src = '/img/pill_1.png';\n\n    this.pills[1].onload = () => {\n      this.pills.push(new Image());\n      this.pills[2].src = '/img/pill_2.png';\n\n      this.pills[2].onload = () => {\n        this.pills.push(new Image());\n        this.pills[3].src = '/img/pill_5.png';\n\n        this.pills[3].onload = () => {\n          this.pills.push(new Image());\n          this.pills[4].src = '/img/pill_8.png';\n\n          this.pills[4].onload = () => {\n            this.pills.push(new Image());\n            this.pills[5].src = '/img/pill_10.png';\n\n            this.pills[5].onload = () => this.render();\n          };\n        };\n      };\n    };\n\n    for (let i = 0; i < this.FIELD_SIZE; i++) {\n      this.field.push([]);\n\n      for (let j = 0; j < this.FIELD_SIZE; j++) {\n        this.field[i][j] = 1 + Math.floor(Math.random() * 5);\n      }\n    }\n  }\n\n  startTimeUpdate() {\n    this.interval = setInterval(() => {\n      this.sec++;\n\n      if (this.sec >= this.ROUND_TIME) {\n        // закончить игру\n        clearInterval(this.interval);\n        this.callbacks.endGame(this.vaccineScore);\n        return;\n      }\n\n      this.callbacks.timeTick(this.ROUND_TIME - this.sec);\n    }, 1000);\n  }\n\n  move(i1, j1, i2, j2) {\n    if (i1 === i2 && Math.abs(j1 - j2) === 1 || Math.abs(i1 - i2) === 1 && j1 === j2) {\n      let c = this.field[i1][j1];\n      this.field[i1][j1] = this.field[i2][j2];\n      this.field[i2][j2] = c;\n\n      if (this.firstStep) {\n        // старт счетчика времени\n        this.firstStep = false;\n        this.startTimeUpdate();\n      }\n\n      this.render();\n      this.getStatus();\n      return true;\n    }\n\n    return false;\n  }\n\n  clickCell(event) {\n    if (this.x >= 0 && this.y >= 0) {\n      let x = Math.floor(event.offsetX / this.SIZE);\n      let y = Math.floor(event.offsetY / this.SIZE);\n      this.move(this.x, this.y, x, y);\n      this.x = -1;\n      this.y = -1;\n    } else {\n      this.x = Math.floor(event.offsetX / this.SIZE);\n      this.y = Math.floor(event.offsetY / this.SIZE);\n    }\n  }\n\n  dropElements() {\n    for (let i = 0; i < this.FIELD_SIZE; i++) {\n      for (let j = 0; j < this.FIELD_SIZE; j++) {\n        if (this.field[i][j - 1] === this.field[i][j - 2] && this.field[i][j] === 0) {\n          if (this.field[i][j - 3]) {\n            this.field[i][j] = this.field[i][j - 3];\n            this.field[i][j - 3] = 0;\n            this.render();\n            this.field[i][j - 1] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 2] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 3] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[i][j - 3] && this.field[i][j - 4]) {\n            this.field[i][j] = this.field[i][j - 3];\n            this.field[i][j - 1] = this.field[i][j - 4];\n            this.field[i][j - 3] = 0;\n            this.field[i][j - 4] = 0;\n            this.render();\n            this.field[i][j - 2] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 3] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 4] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[i][j - 3] && this.field[i][j - 4] && this.field[i][j - 5]) {\n            this.field[i][j] = this.field[i][j - 3];\n            this.field[i][j - 1] = this.field[i][j - 4];\n            this.field[i][j - 2] = this.field[i][j - 5];\n            this.field[i][j - 3] = 0;\n            this.field[i][j - 4] = 0;\n            this.field[i][j - 5] = 0;\n            this.render();\n            this.field[i][j - 3] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 4] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 5] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[i][j - 3] && this.field[i][j - 4] && this.field[i][j - 5] && this.field[i][j - 6]) {\n            this.field[i][j] = this.field[i][j - 3];\n            this.field[i][j - 1] = this.field[i][j - 4];\n            this.field[i][j - 2] = this.field[i][j - 5];\n            this.field[i][j - 3] = this.field[i][j - 6];\n            this.field[i][j - 4] = 0;\n            this.field[i][j - 5] = 0;\n            this.field[i][j - 6] = 0;\n            this.render();\n            this.field[i][j - 4] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 5] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 6] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[i][j - 3] && this.field[i][j - 4] && this.field[i][j - 5] && this.field[i][j - 6] && this.field[i][j - 7]) {\n            this.field[i][j] = this.field[i][j - 3];\n            this.field[i][j - 1] = this.field[i][j - 4];\n            this.field[i][j - 2] = this.field[i][j - 5];\n            this.field[i][j - 3] = this.field[i][j - 6];\n            this.field[i][j - 4] = this.field[i][j - 7];\n            this.field[i][j - 5] = 0;\n            this.field[i][j - 6] = 0;\n            this.field[i][j - 7] = 0;\n            this.render();\n            this.field[i][j - 5] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 6] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 7] = 1 + Math.floor(Math.random() * 5);\n          } else {\n            this.render();\n            this.field[i][j] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 1] = 1 + Math.floor(Math.random() * 5);\n            this.field[i][j - 2] = 1 + Math.floor(Math.random() * 5);\n          }\n        }\n      }\n    }\n\n    for (let i = 0; i < this.FIELD_SIZE; i++) {\n      for (let j = 0; j < this.FIELD_SIZE; j++) {\n        if (this.field[j][i - 1] === this.field[j][i - 2] && this.field[j][i] === 0) {\n          if (this.field[j][i - 3]) {\n            this.field[j][i] = this.field[j][i - 3];\n            this.field[j][i - 3] = 0;\n            this.render();\n            this.field[j][i - 1] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 2] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 3] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[j][i - 3] && this.field[j][i - 4]) {\n            this.field[j][i] = this.field[j][i - 3];\n            this.field[j][i - 1] = this.field[j][i - 4];\n            this.field[j][i - 3] = 0;\n            this.field[j][i - 4] = 0;\n            this.render();\n            this.field[j][i - 2] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 3] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 4] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[j][i - 3] && this.field[j][i - 4] && this.field[j][i - 5]) {\n            this.field[j][i] = this.field[j][i - 3];\n            this.field[j][i - 1] = this.field[j][i - 4];\n            this.field[j][i - 2] = this.field[j][i - 5];\n            this.field[j][i - 3] = 0;\n            this.field[j][i - 4] = 0;\n            this.field[j][i - 5] = 0;\n            this.render();\n            this.field[j][i - 3] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 4] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 5] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[j][i - 3] && this.field[j][i - 4] && this.field[j][i - 5] && this.field[j][i - 6]) {\n            this.field[j][i] = this.field[j][i - 3];\n            this.field[j][i - 1] = this.field[j][i - 4];\n            this.field[j][i - 2] = this.field[j][i - 5];\n            this.field[j][i - 3] = this.field[j][i - 6];\n            this.field[j][i - 4] = 0;\n            this.field[j][i - 5] = 0;\n            this.field[j][i - 6] = 0;\n            this.render();\n            this.field[j][i - 4] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 5] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 6] = 1 + Math.floor(Math.random() * 5);\n          }\n\n          if (this.field[j][i - 3] && this.field[j][i - 4] && this.field[j][i - 5] && this.field[j][i - 6] && this.field[j][i - 7]) {\n            this.field[j][i] = this.field[j][i - 3];\n            this.field[j][i - 1] = this.field[j][i - 4];\n            this.field[j][i - 2] = this.field[j][i - 5];\n            this.field[j][i - 3] = this.field[j][i - 6];\n            this.field[j][i - 4] = this.field[j][i - 7];\n            this.field[j][i - 5] = 0;\n            this.field[j][i - 6] = 0;\n            this.field[j][i - 7] = 0;\n            this.render();\n            this.field[j][i - 5] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 6] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 7] = 1 + Math.floor(Math.random() * 5);\n          } else {\n            this.render();\n            this.field[j][i] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 1] = 1 + Math.floor(Math.random() * 5);\n            this.field[j][i - 2] = 1 + Math.floor(Math.random() * 5);\n          }\n        }\n      }\n    }\n  }\n\n  getStatus() {\n    let a1 = 0;\n    let a2 = 0; // пройтись по всем столбцам, блеат!\n\n    for (let i = 0; i < this.FIELD_SIZE; i++) {\n      a1 = 0;\n      a2 = 0;\n\n      for (let j = 0; j < this.FIELD_SIZE; j++) {\n        if (a1 === a2 && a2 === this.field[i][j]) {\n          this.field[i][j] = 0;\n          this.field[i][j - 1] = 0;\n          this.field[i][j - 2] = 0; //this.dropElements()\n\n          this.render(); //return this.getStatus();\n        } else if (a1 === a2 && a2 !== this.field[i][j]) {\n          a1 = this.field[i][j];\n          a2 = 0;\n        } else if (a1 === this.field[i][j]) {\n          a2 = this.field[i][j];\n        } else {\n          a1 = this.field[i][j];\n        }\n      }\n    } // пробежаться по строкам\n\n    /*for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n        a1 = 0;\r\n        a2 = 0;\r\n        for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n            if (a1 === a2 && a2 === this.field[j][i]) {\r\n                this.field[j][i] = 0;\r\n                this.field[j][i-1] = 0;\r\n                this.field[j][i-2] = 0;\r\n                  //this.dropElements()\r\n                //...\r\n                // добавить выпадалку\r\n                //...\r\n                this.render();\r\n                //return this.getStatus();\r\n            } else if (a1 === a2 && a2 !== this.field[j][i]) {\r\n                a1 = this.field[j][i];\r\n                a2 = 0;\r\n            } else if (a1 === this.field[j][i]) {\r\n                a2 = this.field[j][i];\r\n            } else {\r\n                a1 = this.field[j][i];\r\n            }\r\n        }\r\n    }*/\n\n  }\n\n  isGameOver() {}\n\n  removeLines() {}\n\n  getNewLevel() {\n    /*this.count = 0;\r\n    if (this.pills >= 20) {\r\n       this.count += 1;\r\n    }\r\n    this.pills += 10;*/\n  }\n\n  clear() {\n    this.context.fillStyle = 'purple';\n    this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n\n  render() {\n    this.clear();\n\n    for (let i = 0; i < this.field.length; i++) {\n      for (let j = 0; j < this.field.length; j++) {\n        //console.log(i, j, this.field[i][j]);\n        if (this.field[i][j]) {\n          this.context.drawImage(this.pills[this.field[i][j]], i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE);\n        } else {\n          this.context.fillRect(i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE);\n        }\n      }\n    }\n  }\n\n}\n\nexport default GameDrPill;","map":{"version":3,"sources":["D:/test/vs_studio/dr-pill/src/components/Game/GameDrPill.js"],"names":["GameDrPill","constructor","id","callbacks","canvas","document","getElementById","context","getContext","width","height","addEventListener","event","clickCell","ADD_PILLS","FIELD_SIZE","ROUND_TIME","SIZE","field","sec","interval","currentPills","requirePills","vaccineScore","firstStep","x","y","pills","push","Image","src","onload","render","i","j","Math","floor","random","startTimeUpdate","setInterval","clearInterval","endGame","timeTick","move","i1","j1","i2","j2","abs","c","getStatus","offsetX","offsetY","dropElements","a1","a2","isGameOver","removeLines","getNewLevel","clear","fillStyle","fillRect","length","drawImage"],"mappings":"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","sourcesContent":["class GameDrPill {\r\n    constructor({ id, callbacks }) {\r\n        this.canvas = document.getElementById(id);\r\n        this.context = this.canvas.getContext('2d');\r\n        this.canvas.width = 560;\r\n        this.canvas.height = 560;\r\n        this.canvas.addEventListener('click', (event) => this.clickCell(event));\r\n\r\n        this.ADD_PILLS = 10;\r\n        this.FIELD_SIZE = 8;\r\n        this.ROUND_TIME = 60; // sec\r\n        this.SIZE = 70;\r\n\r\n        this.callbacks = callbacks;\r\n\r\n        this.field = [];\r\n        this.sec = 0;\r\n        this.interval = null;\r\n        this.currentPills = 0;\r\n        this.requirePills = 20;\r\n        this.vaccineScore = 0;\r\n        this.firstStep = true;\r\n        this.x = -1;\r\n        this.y = -1;\r\n\r\n        this.pills = [null];\r\n        this.pills.push(new Image());\r\n        this.pills[1].src = '/img/pill_1.png';\r\n        this.pills[1].onload = () => {\r\n            this.pills.push(new Image());\r\n            this.pills[2].src = '/img/pill_2.png';\r\n            this.pills[2].onload = () => {\r\n                this.pills.push(new Image());\r\n                this.pills[3].src = '/img/pill_5.png';\r\n                this.pills[3].onload = () => {\r\n                    this.pills.push(new Image());\r\n                    this.pills[4].src = '/img/pill_8.png';\r\n                    this.pills[4].onload = () => {\r\n                        this.pills.push(new Image());\r\n                        this.pills[5].src = '/img/pill_10.png';\r\n                        this.pills[5].onload = () => this.render();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            this.field.push([]);\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                this.field[i][j] = 1 + Math.floor(Math.random() * 5);\r\n            }\r\n        }\r\n    }\r\n\r\n    startTimeUpdate() {\r\n        this.interval = setInterval(() => {\r\n            this.sec++;\r\n            if (this.sec >= this.ROUND_TIME) { // закончить игру\r\n                clearInterval(this.interval);\r\n                this.callbacks.endGame(this.vaccineScore);\r\n                return;\r\n            }\r\n            this.callbacks.timeTick(this.ROUND_TIME - this.sec);\r\n        }, 1000);\r\n    }\r\n\r\n    move(i1, j1, i2, j2) {\r\n        if ((i1 === i2 && Math.abs(j1 - j2) === 1) ||\r\n            (Math.abs(i1 - i2) === 1 && j1 === j2)) {\r\n            let c = this.field[i1][j1];\r\n            this.field[i1][j1] = this.field[i2][j2];\r\n            this.field[i2][j2] = c;\r\n            if (this.firstStep) { // старт счетчика времени\r\n                this.firstStep = false;\r\n                this.startTimeUpdate();\r\n            }\r\n            this.render();\r\n            this.getStatus();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n\r\n    clickCell(event) {\r\n        if (this.x >= 0 && this.y >= 0) {\r\n            let x = Math.floor(event.offsetX / this.SIZE);\r\n            let y = Math.floor(event.offsetY / this.SIZE);\r\n            this.move(this.x, this.y, x, y);\r\n            this.x = -1;\r\n            this.y = -1;\r\n        } else {\r\n            this.x = Math.floor(event.offsetX / this.SIZE);\r\n            this.y = Math.floor(event.offsetY / this.SIZE);\r\n        }\r\n    }\r\n\r\n    dropElements() {\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                if (this.field[i][j-1] === this.field[i][j-2] && this.field[i][j] === 0) {\r\n                    if (this.field[i][j-3]) {\r\n                        this.field[i][j] = this.field[i][j-3];\r\n                        this.field[i][j-3] = 0;\r\n                        this.render();\r\n                        this.field[i][j-1] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-2] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-3] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[i][j-3] && this.field[i][j-4]) {\r\n                        this.field[i][j] = this.field[i][j-3];\r\n                        this.field[i][j-1] = this.field[i][j-4];\r\n                        this.field[i][j-3] = 0;\r\n                        this.field[i][j-4] = 0;\r\n                        this.render();\r\n                        this.field[i][j-2] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-3] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-4] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[i][j-3] && this.field[i][j-4] && this.field[i][j-5]) {\r\n                        this.field[i][j] = this.field[i][j-3];\r\n                        this.field[i][j-1] = this.field[i][j-4];\r\n                        this.field[i][j-2] = this.field[i][j-5];\r\n                        this.field[i][j-3] = 0;\r\n                        this.field[i][j-4] = 0;\r\n                        this.field[i][j-5] = 0;\r\n                        this.render();\r\n                        this.field[i][j-3] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-4] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-5] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[i][j-3] && this.field[i][j-4] && this.field[i][j-5] && this.field[i][j-6]) {\r\n                        this.field[i][j] = this.field[i][j-3];\r\n                        this.field[i][j-1] = this.field[i][j-4];\r\n                        this.field[i][j-2] = this.field[i][j-5];\r\n                        this.field[i][j-3] = this.field[i][j-6];\r\n                        this.field[i][j-4] = 0;\r\n                        this.field[i][j-5] = 0;\r\n                        this.field[i][j-6] = 0;\r\n                        this.render();\r\n                        this.field[i][j-4] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-5] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-6] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[i][j-3] && this.field[i][j-4] && this.field[i][j-5] && this.field[i][j-6] && this.field[i][j-7]) {\r\n                        this.field[i][j] = this.field[i][j-3];\r\n                        this.field[i][j-1] = this.field[i][j-4];\r\n                        this.field[i][j-2] = this.field[i][j-5];\r\n                        this.field[i][j-3] = this.field[i][j-6];\r\n                        this.field[i][j-4] = this.field[i][j-7];\r\n                        this.field[i][j-5] = 0;\r\n                        this.field[i][j-6] = 0;\r\n                        this.field[i][j-7] = 0;\r\n                        this.render();\r\n                        this.field[i][j-5] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-6] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-7] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    else {\r\n                        this.render();\r\n                        this.field[i][j] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-1] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[i][j-2] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                if (this.field[j][i-1] === this.field[j][i-2] && this.field[j][i] === 0) {\r\n                    if (this.field[j][i-3]) {\r\n                        this.field[j][i] = this.field[j][i-3];\r\n                        this.field[j][i-3] = 0;\r\n                        this.render();\r\n                        this.field[j][i-1] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-2] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-3] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[j][i-3] && this.field[j][i-4]) {\r\n                        this.field[j][i] = this.field[j][i-3];\r\n                        this.field[j][i-1] = this.field[j][i-4];\r\n                        this.field[j][i-3] = 0;\r\n                        this.field[j][i-4] = 0;\r\n                        this.render();\r\n                        this.field[j][i-2] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-3] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-4] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[j][i-3] && this.field[j][i-4] && this.field[j][i-5]) {\r\n                        this.field[j][i] = this.field[j][i-3];\r\n                        this.field[j][i-1] = this.field[j][i-4];\r\n                        this.field[j][i-2] = this.field[j][i-5];\r\n                        this.field[j][i-3] = 0;\r\n                        this.field[j][i-4] = 0;\r\n                        this.field[j][i-5] = 0;\r\n                        this.render();\r\n                        this.field[j][i-3] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-4] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-5] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[j][i-3] && this.field[j][i-4] && this.field[j][i-5] && this.field[j][i-6]) {\r\n                        this.field[j][i] = this.field[j][i-3];\r\n                        this.field[j][i-1] = this.field[j][i-4];\r\n                        this.field[j][i-2] = this.field[j][i-5];\r\n                        this.field[j][i-3] = this.field[j][i-6];\r\n                        this.field[j][i-4] = 0;\r\n                        this.field[j][i-5] = 0;\r\n                        this.field[j][i-6] = 0;\r\n                        this.render();\r\n                        this.field[j][i-4] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-5] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-6] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    if (this.field[j][i-3] && this.field[j][i-4] && this.field[j][i-5] && this.field[j][i-6] && this.field[j][i-7]) {\r\n                        this.field[j][i] = this.field[j][i-3];\r\n                        this.field[j][i-1] = this.field[j][i-4];\r\n                        this.field[j][i-2] = this.field[j][i-5];\r\n                        this.field[j][i-3] = this.field[j][i-6];\r\n                        this.field[j][i-4] = this.field[j][i-7];\r\n                        this.field[j][i-5] = 0;\r\n                        this.field[j][i-6] = 0;\r\n                        this.field[j][i-7] = 0;\r\n                        this.render();\r\n                        this.field[j][i-5] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-6] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-7] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                    else {\r\n                        this.render();\r\n                        this.field[j][i] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-1] = 1 + Math.floor(Math.random() * 5);\r\n                        this.field[j][i-2] = 1 + Math.floor(Math.random() * 5);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getStatus() {\r\n        let a1 = 0;\r\n        let a2 = 0;\r\n        // пройтись по всем столбцам, блеат!\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            a1 = 0;\r\n            a2 = 0;\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                if (a1 === a2 && a2 === this.field[i][j]) {\r\n                    this.field[i][j] = 0;\r\n                    this.field[i][j-1] = 0;\r\n                    this.field[i][j-2] = 0;\r\n\r\n                    //this.dropElements()\r\n                    \r\n                    this.render();\r\n                    //return this.getStatus();\r\n                } else if (a1 === a2 && a2 !== this.field[i][j]) {\r\n                    a1 = this.field[i][j];\r\n                    a2 = 0;\r\n                } else if (a1 === this.field[i][j]) {\r\n                    a2 = this.field[i][j];\r\n                } else {\r\n                    a1 = this.field[i][j];\r\n                }\r\n            }\r\n        }\r\n        // пробежаться по строкам\r\n        /*for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            a1 = 0;\r\n            a2 = 0;\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                if (a1 === a2 && a2 === this.field[j][i]) {\r\n                    this.field[j][i] = 0;\r\n                    this.field[j][i-1] = 0;\r\n                    this.field[j][i-2] = 0;\r\n\r\n                    //this.dropElements()\r\n                    //...\r\n                    // добавить выпадалку\r\n                    //...\r\n                    this.render();\r\n                    //return this.getStatus();\r\n                } else if (a1 === a2 && a2 !== this.field[j][i]) {\r\n                    a1 = this.field[j][i];\r\n                    a2 = 0;\r\n                } else if (a1 === this.field[j][i]) {\r\n                    a2 = this.field[j][i];\r\n                } else {\r\n                    a1 = this.field[j][i];\r\n                }\r\n            }\r\n        }*/\r\n    }\r\n\r\n    isGameOver() { }\r\n\r\n    removeLines() { }\r\n\r\n    getNewLevel() {\r\n        /*this.count = 0;\r\n        if (this.pills >= 20) {\r\n           this.count += 1;\r\n        }\r\n        this.pills += 10;*/\r\n    }\r\n\r\n    clear() {\r\n        this.context.fillStyle = 'purple';\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    render() {\r\n        this.clear();\r\n        for (let i = 0; i < this.field.length; i++) {\r\n            for (let j = 0; j < this.field.length; j++) {\r\n\r\n                //console.log(i, j, this.field[i][j]);\r\n\r\n                if (this.field[i][j]) {\r\n                    this.context.drawImage(this.pills[this.field[i][j]], i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE);\r\n                } else {\r\n                    this.context.fillRect(i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE)\r\n                }\r\n\r\n                \r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default GameDrPill;"]},"metadata":{},"sourceType":"module"}