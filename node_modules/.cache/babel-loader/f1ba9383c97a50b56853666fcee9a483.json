{"ast":null,"code":"import _classCallCheck from\"D:/test/vs_studio/dr-pill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/test/vs_studio/dr-pill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";var GameDrPill=/*#__PURE__*/function(){function GameDrPill(_ref){var _this=this;var id=_ref.id,callbacks=_ref.callbacks;_classCallCheck(this,GameDrPill);this.canvas=document.getElementById(id);this.context=this.canvas.getContext('2d');this.canvas.width=560;this.canvas.height=560;this.canvas.addEventListener('click',function(event){return _this.clickCell(event);});this.canvas.addEventListener('mousemove',function(event){return _this.moveCell(event);});this.canvas.addEventListener('mouseup',function(){return _this.upCell();});this.canvas.addEventListener('mousedown',function(event){return _this.downCell(event);});this.ADD_PILLS=10;this.FIELD_SIZE=8;this.ROUND_TIME=60;// sec\nthis.SIZE=70;this.callbacks=callbacks;this.field=[];this.sec=0;this.interval=null;this.currentPills=0;this.requirePills=20;this.vaccineScore=0;this.firstStep=true;this.x=-1;this.y=-1;this.isDrug=null;this.drugX=-1;this.drugY=-1;this.booms=[];this.boomImages=[];this.boomImages.push(new Image());this.boomImages[0].src='/img/1.png';this.boomImages.push(new Image());this.boomImages[1].src='/img/2.png';this.boomImages.push(new Image());this.boomImages[2].src='/img/3.png';this.boomImages.push(new Image());this.boomImages[3].src='/img/4.png';this.boomImages.push(new Image());this.boomImages[4].src='/img/5.png';this.boomImages.push(new Image());this.boomImages[5].src='/img/6.png';this.boomImages.push(new Image());this.boomImages[6].src='/img/7.png';this.boomImages.push(new Image());this.boomImages[7].src='/img/8.png';this.boomImages.push(new Image());this.boomImages[8].src='/img/9.png';this.boomImages.push(new Image());this.boomImages[9].src='/img/10.png';this.boomImages.push(new Image());this.boomImages[10].src='/img/11.png';this.pills=[null];this.pills.push(new Image());this.pills[1].src='/img/pill_1.png';this.pills[1].onload=function(){_this.pills.push(new Image());_this.pills[2].src='/img/pill_2.png';_this.pills[2].onload=function(){_this.pills.push(new Image());_this.pills[3].src='/img/pill_5.png';_this.pills[3].onload=function(){_this.pills.push(new Image());_this.pills[4].src='/img/pill_8.png';_this.pills[4].onload=function(){_this.pills.push(new Image());_this.pills[5].src='/img/pill_10.png';_this.pills[5].onload=function(){return _this.render();};};};};};for(var i=0;i<this.FIELD_SIZE;i++){this.field.push([]);for(var j=0;j<this.FIELD_SIZE;j++){this.field[i][j]=1+Math.floor(Math.random()*5);}}}_createClass(GameDrPill,[{key:\"startTimeUpdate\",value:function startTimeUpdate(){var _this2=this;if(this.interval){this.sec=0;clearInterval(this.interval);}this.interval=setInterval(function(){_this2.sec++;if(_this2.sec>=_this2.ROUND_TIME){// закончить игру\nclearInterval(_this2.interval);_this2.callbacks.endGame(_this2.vaccineScore);return;}_this2.callbacks.timeTick(_this2.ROUND_TIME-_this2.sec);},1000);}},{key:\"move\",value:function move(i1,j1,i2,j2){if(i1===i2&&Math.abs(j1-j2)===1||Math.abs(i1-i2)===1&&j1===j2){var c=this.field[i1][j1];this.field[i1][j1]=this.field[i2][j2];this.field[i2][j2]=c;if(this.firstStep){// старт счетчика времени\nthis.firstStep=false;this.startTimeUpdate();}this.render();this.getStatus();return true;}return false;}},{key:\"moveCell\",value:function moveCell(event){if(this.isDrug){if(this.drugX>=0&&this.drugY>=0){this.render();if(this.field[this.drugX][this.drugY]){this.context.drawImage(this.pills[this.field[this.drugX][this.drugY]],event.offsetX-this.SIZE/2,event.offsetY-this.SIZE/2,this.SIZE,this.SIZE);var x=Math.floor(event.offsetX/this.SIZE);var y=Math.floor(event.offsetY/this.SIZE);if(Math.abs(x+y-(this.drugX+this.drugY))===1){this.move(this.drugX,this.drugY,x,y);this.upCell();}}}}}},{key:\"upCell\",value:function upCell(){this.isDrug=false;this.drugX=-1;this.drugY=-1;}},{key:\"downCell\",value:function downCell(event){this.isDrug=true;this.drugX=Math.floor(event.offsetX/this.SIZE);this.drugY=Math.floor(event.offsetY/this.SIZE);}},{key:\"clickCell\",value:function clickCell(event){if(this.x>=0&&this.y>=0){var x=Math.floor(event.offsetX/this.SIZE);var y=Math.floor(event.offsetY/this.SIZE);this.move(this.x,this.y,x,y);this.x=-1;this.y=-1;}else{this.x=Math.floor(event.offsetX/this.SIZE);this.y=Math.floor(event.offsetY/this.SIZE);}}},{key:\"dropOneCell\",value:function dropOneCell(i,j){if(j===0){this.field[i][j]=1+Math.floor(Math.random()*5);}else{for(var k=j;k>=0;k--){if(this.field[i][k-1]!==undefined){this.field[i][k]=this.field[i][k-1];this.field[i][k-1]=0;}else{this.field[i][k]=1+Math.floor(Math.random()*5);}}}}},{key:\"dropElements\",value:function dropElements(){for(var j=0;j<this.FIELD_SIZE;j++){for(var i=0;i<this.FIELD_SIZE;i++){if(this.field[i][j]===0){this.dropOneCell(i,j);this.render();}}}}},{key:\"getStatus\",value:function getStatus(){var _this3=this;var a1=0;var a2=0;// пробежаться по столбцам\nfor(var i=0;i<this.FIELD_SIZE;i++){a1=0;a2=0;for(var j=0;j<this.FIELD_SIZE;j++){if(a1&&a1===a2&&a2===this.field[i][j]){this.field[i][j]=0;this.field[i][j-1]=0;this.field[i][j-2]=0;this.booms.push({i:i,j:j,currentImage:-1});this.booms.push({i:i,j:j-1,currentImage:-1});this.booms.push({i:i,j:j-2,currentImage:-1});setTimeout(function(){return _this3.dropElements();},1500);this.render();this.callbacks.addPills(3);}else if(a1&&a1===a2&&a2!==this.field[i][j]){a1=this.field[i][j];a2=0;}else if(a1&&a1===this.field[i][j]){a2=this.field[i][j];}else{a1=this.field[i][j];}}}// пробежаться по строки\nfor(var _j=0;_j<this.FIELD_SIZE;_j++){a1=0;a2=0;for(var _i=0;_i<this.FIELD_SIZE;_i++){if(a1&&a1===a2&&a2===this.field[_i][_j]){this.field[_i][_j]=0;this.field[_i-1][_j]=0;this.field[_i-2][_j]=0;this.booms.push({i:_i,j:_j,currentImage:-1});this.booms.push({i:_i-1,j:_j,currentImage:-1});this.booms.push({i:_i-2,j:_j,currentImage:-1});setTimeout(function(){return _this3.dropElements();},1500);this.render();this.callbacks.addPills(3);}else if(a1&&a1===a2&&a2!==this.field[_i][_j]){a1=this.field[_i][_j];a2=0;}else if(a1&&a1===this.field[_i][_j]){a2=this.field[_i][_j];}else{a1=this.field[_i][_j];}}}}},{key:\"restartTime\",value:function restartTime(){this.startTimeUpdate();}},{key:\"clear\",value:function clear(){for(var i=0;i<6;i++){for(var j=0;j<6;j++){this.context.fillStyle=\"rgb(\\n            \".concat(Math.floor(255-42.5*i),\",\\n            \").concat(Math.floor(255-42.5*j),\",\\n            0)\");this.context.fillRect(0,0,this.canvas.width,this.canvas.height);}}}},{key:\"render\",value:function render(){var _this4=this;this.clear();// очистка\n// нарисовать пилюльки\nfor(var i=0;i<this.field.length;i++){for(var j=0;j<this.field.length;j++){if(this.field[i][j]){if(this.drugX===i&&this.drugY===j){continue;}this.context.drawImage(this.pills[this.field[i][j]],i*this.SIZE,j*this.SIZE,this.SIZE,this.SIZE);}else{this.context.fillRect(i*this.SIZE,j*this.SIZE,this.SIZE,this.SIZE);}}}// нарисовать бумсы\nvar refresh=false;for(var _i2=this.booms.length-1;_i2>=0;_i2--){var boom=this.booms[_i2];if(boom){boom.currentImage++;if(boom.currentImage>=this.boomImages.length){this.booms.splice(_i2,1);}else{var _i3=boom.i;var _j2=boom.j;this.context.drawImage(this.boomImages[boom.currentImage],_i3*this.SIZE,_j2*this.SIZE,this.SIZE,this.SIZE);refresh=true;}}}if(refresh){setTimeout(function(){return _this4.render();},125);}}}]);return GameDrPill;}();export default GameDrPill;","map":{"version":3,"sources":["D:/test/vs_studio/dr-pill/src/components/Game/GameDrPill.js"],"names":["GameDrPill","id","callbacks","canvas","document","getElementById","context","getContext","width","height","addEventListener","event","clickCell","moveCell","upCell","downCell","ADD_PILLS","FIELD_SIZE","ROUND_TIME","SIZE","field","sec","interval","currentPills","requirePills","vaccineScore","firstStep","x","y","isDrug","drugX","drugY","booms","boomImages","push","Image","src","pills","onload","render","i","j","Math","floor","random","clearInterval","setInterval","endGame","timeTick","i1","j1","i2","j2","abs","c","startTimeUpdate","getStatus","drawImage","offsetX","offsetY","move","k","undefined","dropOneCell","a1","a2","currentImage","setTimeout","dropElements","addPills","fillStyle","fillRect","clear","length","refresh","boom","splice"],"mappings":"iSAAMA,CAAAA,U,yBACF,yBAA+B,mBAAjBC,CAAAA,EAAiB,MAAjBA,EAAiB,CAAbC,SAAa,MAAbA,SAAa,kCAC3B,KAAKC,MAAL,CAAcC,QAAQ,CAACC,cAAT,CAAwBJ,EAAxB,CAAd,CACA,KAAKK,OAAL,CAAe,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,IAAvB,CAAf,CACA,KAAKJ,MAAL,CAAYK,KAAZ,CAAoB,GAApB,CACA,KAAKL,MAAL,CAAYM,MAAZ,CAAqB,GAArB,CACA,KAAKN,MAAL,CAAYO,gBAAZ,CAA6B,OAA7B,CAAsC,SAACC,KAAD,QAAW,CAAA,KAAI,CAACC,SAAL,CAAeD,KAAf,CAAX,EAAtC,EACA,KAAKR,MAAL,CAAYO,gBAAZ,CAA6B,WAA7B,CAA0C,SAACC,KAAD,QAAW,CAAA,KAAI,CAACE,QAAL,CAAcF,KAAd,CAAX,EAA1C,EACA,KAAKR,MAAL,CAAYO,gBAAZ,CAA6B,SAA7B,CAAwC,iBAAM,CAAA,KAAI,CAACI,MAAL,EAAN,EAAxC,EACA,KAAKX,MAAL,CAAYO,gBAAZ,CAA6B,WAA7B,CAA0C,SAACC,KAAD,QAAW,CAAA,KAAI,CAACI,QAAL,CAAcJ,KAAd,CAAX,EAA1C,EAEA,KAAKK,SAAL,CAAiB,EAAjB,CACA,KAAKC,UAAL,CAAkB,CAAlB,CACA,KAAKC,UAAL,CAAkB,EAAlB,CAAsB;AACtB,KAAKC,IAAL,CAAY,EAAZ,CAEA,KAAKjB,SAAL,CAAiBA,SAAjB,CAEA,KAAKkB,KAAL,CAAa,EAAb,CACA,KAAKC,GAAL,CAAW,CAAX,CACA,KAAKC,QAAL,CAAgB,IAAhB,CACA,KAAKC,YAAL,CAAoB,CAApB,CACA,KAAKC,YAAL,CAAoB,EAApB,CACA,KAAKC,YAAL,CAAoB,CAApB,CACA,KAAKC,SAAL,CAAiB,IAAjB,CACA,KAAKC,CAAL,CAAS,CAAC,CAAV,CACA,KAAKC,CAAL,CAAS,CAAC,CAAV,CACA,KAAKC,MAAL,CAAc,IAAd,CACA,KAAKC,KAAL,CAAa,CAAC,CAAd,CACA,KAAKC,KAAL,CAAa,CAAC,CAAd,CAEA,KAAKC,KAAL,CAAa,EAAb,CACA,KAAKC,UAAL,CAAkB,EAAlB,CACA,KAAKA,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,YAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,CAAhB,EAAmBG,GAAnB,CAAyB,aAAzB,CACA,KAAKH,UAAL,CAAgBC,IAAhB,CAAqB,GAAIC,CAAAA,KAAJ,EAArB,EACA,KAAKF,UAAL,CAAgB,EAAhB,EAAoBG,GAApB,CAA0B,aAA1B,CAEA,KAAKC,KAAL,CAAa,CAAC,IAAD,CAAb,CACA,KAAKA,KAAL,CAAWH,IAAX,CAAgB,GAAIC,CAAAA,KAAJ,EAAhB,EACA,KAAKE,KAAL,CAAW,CAAX,EAAcD,GAAd,CAAoB,iBAApB,CACA,KAAKC,KAAL,CAAW,CAAX,EAAcC,MAAd,CAAuB,UAAM,CACzB,KAAI,CAACD,KAAL,CAAWH,IAAX,CAAgB,GAAIC,CAAAA,KAAJ,EAAhB,EACA,KAAI,CAACE,KAAL,CAAW,CAAX,EAAcD,GAAd,CAAoB,iBAApB,CACA,KAAI,CAACC,KAAL,CAAW,CAAX,EAAcC,MAAd,CAAuB,UAAM,CACzB,KAAI,CAACD,KAAL,CAAWH,IAAX,CAAgB,GAAIC,CAAAA,KAAJ,EAAhB,EACA,KAAI,CAACE,KAAL,CAAW,CAAX,EAAcD,GAAd,CAAoB,iBAApB,CACA,KAAI,CAACC,KAAL,CAAW,CAAX,EAAcC,MAAd,CAAuB,UAAM,CACzB,KAAI,CAACD,KAAL,CAAWH,IAAX,CAAgB,GAAIC,CAAAA,KAAJ,EAAhB,EACA,KAAI,CAACE,KAAL,CAAW,CAAX,EAAcD,GAAd,CAAoB,iBAApB,CACA,KAAI,CAACC,KAAL,CAAW,CAAX,EAAcC,MAAd,CAAuB,UAAM,CACzB,KAAI,CAACD,KAAL,CAAWH,IAAX,CAAgB,GAAIC,CAAAA,KAAJ,EAAhB,EACA,KAAI,CAACE,KAAL,CAAW,CAAX,EAAcD,GAAd,CAAoB,kBAApB,CACA,KAAI,CAACC,KAAL,CAAW,CAAX,EAAcC,MAAd,CAAuB,iBAAM,CAAA,KAAI,CAACC,MAAL,EAAN,EAAvB,CACH,CAJD,CAKH,CARD,CASH,CAZD,CAaH,CAhBD,CAkBA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKvB,UAAzB,CAAqCuB,CAAC,EAAtC,CAA0C,CACtC,KAAKpB,KAAL,CAAWc,IAAX,CAAgB,EAAhB,EACA,IAAK,GAAIO,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKxB,UAAzB,CAAqCwB,CAAC,EAAtC,CAA0C,CACtC,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,EAAmB,EAAIC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgB,CAA3B,CAAvB,CACH,CACJ,CACJ,C,gFAEiB,iBACd,GAAI,KAAKtB,QAAT,CAAmB,CACf,KAAKD,GAAL,CAAW,CAAX,CACAwB,aAAa,CAAC,KAAKvB,QAAN,CAAb,CACH,CACD,KAAKA,QAAL,CAAgBwB,WAAW,CAAC,UAAM,CAC9B,MAAI,CAACzB,GAAL,GACA,GAAI,MAAI,CAACA,GAAL,EAAY,MAAI,CAACH,UAArB,CAAiC,CAAE;AAC/B2B,aAAa,CAAC,MAAI,CAACvB,QAAN,CAAb,CACA,MAAI,CAACpB,SAAL,CAAe6C,OAAf,CAAuB,MAAI,CAACtB,YAA5B,EACA,OACH,CACD,MAAI,CAACvB,SAAL,CAAe8C,QAAf,CAAwB,MAAI,CAAC9B,UAAL,CAAkB,MAAI,CAACG,GAA/C,EACH,CAR0B,CAQxB,IARwB,CAA3B,CASH,C,kCAEI4B,E,CAAIC,E,CAAIC,E,CAAIC,E,CAAI,CACjB,GAAKH,EAAE,GAAKE,EAAP,EAAaT,IAAI,CAACW,GAAL,CAASH,EAAE,CAAGE,EAAd,IAAsB,CAApC,EACCV,IAAI,CAACW,GAAL,CAASJ,EAAE,CAAGE,EAAd,IAAsB,CAAtB,EAA2BD,EAAE,GAAKE,EADvC,CAC4C,CACxC,GAAIE,CAAAA,CAAC,CAAG,KAAKlC,KAAL,CAAW6B,EAAX,EAAeC,EAAf,CAAR,CACA,KAAK9B,KAAL,CAAW6B,EAAX,EAAeC,EAAf,EAAqB,KAAK9B,KAAL,CAAW+B,EAAX,EAAeC,EAAf,CAArB,CACA,KAAKhC,KAAL,CAAW+B,EAAX,EAAeC,EAAf,EAAqBE,CAArB,CACA,GAAI,KAAK5B,SAAT,CAAoB,CAAE;AAClB,KAAKA,SAAL,CAAiB,KAAjB,CACA,KAAK6B,eAAL,GACH,CACD,KAAKhB,MAAL,GACA,KAAKiB,SAAL,GACA,MAAO,KAAP,CACH,CACD,MAAO,MAAP,CACH,C,0CAEQ7C,K,CAAO,CACZ,GAAI,KAAKkB,MAAT,CAAiB,CACb,GAAI,KAAKC,KAAL,EAAc,CAAd,EAAmB,KAAKC,KAAL,EAAc,CAArC,CAAwC,CACpC,KAAKQ,MAAL,GACA,GAAI,KAAKnB,KAAL,CAAW,KAAKU,KAAhB,EAAuB,KAAKC,KAA5B,CAAJ,CAAwC,CACpC,KAAKzB,OAAL,CAAamD,SAAb,CACI,KAAKpB,KAAL,CAAW,KAAKjB,KAAL,CAAW,KAAKU,KAAhB,EAAuB,KAAKC,KAA5B,CAAX,CADJ,CAEIpB,KAAK,CAAC+C,OAAN,CAAgB,KAAKvC,IAAL,CAAY,CAFhC,CAGIR,KAAK,CAACgD,OAAN,CAAgB,KAAKxC,IAAL,CAAY,CAHhC,CAII,KAAKA,IAJT,CAKI,KAAKA,IALT,EAOA,GAAIQ,CAAAA,CAAC,CAAGe,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAAC+C,OAAN,CAAgB,KAAKvC,IAAhC,CAAR,CACA,GAAIS,CAAAA,CAAC,CAAGc,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAACgD,OAAN,CAAgB,KAAKxC,IAAhC,CAAR,CACA,GAAIuB,IAAI,CAACW,GAAL,CAAU1B,CAAC,CAAGC,CAAL,EAAW,KAAKE,KAAL,CAAa,KAAKC,KAA7B,CAAT,IAAkD,CAAtD,CAAyD,CACrD,KAAK6B,IAAL,CAAU,KAAK9B,KAAf,CAAsB,KAAKC,KAA3B,CAAkCJ,CAAlC,CAAqCC,CAArC,EACA,KAAKd,MAAL,GACH,CACJ,CACJ,CACJ,CACJ,C,uCACQ,CACL,KAAKe,MAAL,CAAc,KAAd,CACA,KAAKC,KAAL,CAAa,CAAC,CAAd,CACA,KAAKC,KAAL,CAAa,CAAC,CAAd,CACH,C,0CAEQpB,K,CAAO,CACZ,KAAKkB,MAAL,CAAc,IAAd,CACA,KAAKC,KAAL,CAAaY,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAAC+C,OAAN,CAAgB,KAAKvC,IAAhC,CAAb,CACA,KAAKY,KAAL,CAAaW,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAACgD,OAAN,CAAgB,KAAKxC,IAAhC,CAAb,CACH,C,4CAESR,K,CAAO,CACb,GAAI,KAAKgB,CAAL,EAAU,CAAV,EAAe,KAAKC,CAAL,EAAU,CAA7B,CAAgC,CAC5B,GAAID,CAAAA,CAAC,CAAGe,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAAC+C,OAAN,CAAgB,KAAKvC,IAAhC,CAAR,CACA,GAAIS,CAAAA,CAAC,CAAGc,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAACgD,OAAN,CAAgB,KAAKxC,IAAhC,CAAR,CACA,KAAKyC,IAAL,CAAU,KAAKjC,CAAf,CAAkB,KAAKC,CAAvB,CAA0BD,CAA1B,CAA6BC,CAA7B,EACA,KAAKD,CAAL,CAAS,CAAC,CAAV,CACA,KAAKC,CAAL,CAAS,CAAC,CAAV,CACH,CAND,IAMO,CACH,KAAKD,CAAL,CAASe,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAAC+C,OAAN,CAAgB,KAAKvC,IAAhC,CAAT,CACA,KAAKS,CAAL,CAASc,IAAI,CAACC,KAAL,CAAWhC,KAAK,CAACgD,OAAN,CAAgB,KAAKxC,IAAhC,CAAT,CACH,CACJ,C,gDAEWqB,C,CAAGC,C,CAAG,CACd,GAAIA,CAAC,GAAK,CAAV,CAAa,CACT,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,EAAmB,EAAIC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgB,CAA3B,CAAvB,CACH,CAFD,IAEO,CACH,IAAK,GAAIiB,CAAAA,CAAC,CAAGpB,CAAb,CAAgBoB,CAAC,EAAI,CAArB,CAAwBA,CAAC,EAAzB,CAA6B,CACzB,GAAI,KAAKzC,KAAL,CAAWoB,CAAX,EAAcqB,CAAC,CAAG,CAAlB,IAAyBC,SAA7B,CAAwC,CACpC,KAAK1C,KAAL,CAAWoB,CAAX,EAAcqB,CAAd,EAAmB,KAAKzC,KAAL,CAAWoB,CAAX,EAAcqB,CAAC,CAAG,CAAlB,CAAnB,CACA,KAAKzC,KAAL,CAAWoB,CAAX,EAAcqB,CAAC,CAAG,CAAlB,EAAuB,CAAvB,CACH,CAHD,IAGO,CACH,KAAKzC,KAAL,CAAWoB,CAAX,EAAcqB,CAAd,EAAmB,EAAInB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgB,CAA3B,CAAvB,CACH,CACJ,CACJ,CACJ,C,mDAEc,CACX,IAAK,GAAIH,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKxB,UAAzB,CAAqCwB,CAAC,EAAtC,CAA0C,CACtC,IAAK,GAAID,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKvB,UAAzB,CAAqCuB,CAAC,EAAtC,CAA0C,CACtC,GAAI,KAAKpB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,IAAqB,CAAzB,CAA4B,CACxB,KAAKsB,WAAL,CAAiBvB,CAAjB,CAAoBC,CAApB,EACA,KAAKF,MAAL,GACH,CACJ,CACJ,CACJ,C,6CAEW,iBACR,GAAIyB,CAAAA,EAAE,CAAG,CAAT,CACA,GAAIC,CAAAA,EAAE,CAAG,CAAT,CACA;AACA,IAAK,GAAIzB,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKvB,UAAzB,CAAqCuB,CAAC,EAAtC,CAA0C,CACtCwB,EAAE,CAAG,CAAL,CACAC,EAAE,CAAG,CAAL,CACA,IAAK,GAAIxB,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKxB,UAAzB,CAAqCwB,CAAC,EAAtC,CAA0C,CACtC,GAAIuB,EAAE,EAAIA,EAAE,GAAKC,EAAb,EAAmBA,EAAE,GAAK,KAAK7C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAA9B,CAAgD,CAC5C,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,EAAmB,CAAnB,CACA,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAC,CAAG,CAAlB,EAAuB,CAAvB,CACA,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAC,CAAG,CAAlB,EAAuB,CAAvB,CACA,KAAKT,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAADA,CAAF,CAAKC,CAAC,CAADA,CAAL,CAAQyB,YAAY,CAAE,CAAC,CAAvB,CAAhB,EACA,KAAKlC,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAADA,CAAF,CAAKC,CAAC,CAAEA,CAAC,CAAG,CAAZ,CAAeyB,YAAY,CAAE,CAAC,CAA9B,CAAhB,EACA,KAAKlC,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAADA,CAAF,CAAKC,CAAC,CAAEA,CAAC,CAAG,CAAZ,CAAeyB,YAAY,CAAE,CAAC,CAA9B,CAAhB,EACAC,UAAU,CAAC,iBAAM,CAAA,MAAI,CAACC,YAAL,EAAN,EAAD,CAA4B,IAA5B,CAAV,CACA,KAAK7B,MAAL,GACA,KAAKrC,SAAL,CAAemE,QAAf,CAAwB,CAAxB,EACH,CAVD,IAUO,IAAIL,EAAE,EAAIA,EAAE,GAAKC,EAAb,EAAmBA,EAAE,GAAK,KAAK7C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAA9B,CAAgD,CACnDuB,EAAE,CAAG,KAAK5C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAL,CACAwB,EAAE,CAAG,CAAL,CACH,CAHM,IAGA,IAAID,EAAE,EAAIA,EAAE,GAAK,KAAK5C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAjB,CAAmC,CACtCwB,EAAE,CAAG,KAAK7C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAL,CACH,CAFM,IAEA,CACHuB,EAAE,CAAG,KAAK5C,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAL,CACH,CACJ,CACJ,CACD;AACA,IAAK,GAAIA,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAG,KAAKxB,UAAzB,CAAqCwB,EAAC,EAAtC,CAA0C,CACtCuB,EAAE,CAAG,CAAL,CACAC,EAAE,CAAG,CAAL,CACA,IAAK,GAAIzB,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAG,KAAKvB,UAAzB,CAAqCuB,EAAC,EAAtC,CAA0C,CACtC,GAAIwB,EAAE,EAAIA,EAAE,GAAKC,EAAb,EAAmBA,EAAE,GAAK,KAAK7C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAA9B,CAAgD,CAC5C,KAAKrB,KAAL,CAAWoB,EAAX,EAAcC,EAAd,EAAmB,CAAnB,CACA,KAAKrB,KAAL,CAAWoB,EAAC,CAAG,CAAf,EAAkBC,EAAlB,EAAuB,CAAvB,CACA,KAAKrB,KAAL,CAAWoB,EAAC,CAAG,CAAf,EAAkBC,EAAlB,EAAuB,CAAvB,CACA,KAAKT,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAADA,EAAF,CAAKC,CAAC,CAADA,EAAL,CAAQyB,YAAY,CAAE,CAAC,CAAvB,CAAhB,EACA,KAAKlC,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAAEA,EAAC,CAAG,CAAT,CAAYC,CAAC,CAADA,EAAZ,CAAeyB,YAAY,CAAE,CAAC,CAA9B,CAAhB,EACA,KAAKlC,KAAL,CAAWE,IAAX,CAAgB,CAAEM,CAAC,CAAEA,EAAC,CAAG,CAAT,CAAYC,CAAC,CAADA,EAAZ,CAAeyB,YAAY,CAAE,CAAC,CAA9B,CAAhB,EACAC,UAAU,CAAC,iBAAM,CAAA,MAAI,CAACC,YAAL,EAAN,EAAD,CAA4B,IAA5B,CAAV,CACA,KAAK7B,MAAL,GACA,KAAKrC,SAAL,CAAemE,QAAf,CAAwB,CAAxB,EACH,CAVD,IAUO,IAAIL,EAAE,EAAIA,EAAE,GAAKC,EAAb,EAAmBA,EAAE,GAAK,KAAK7C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAA9B,CAAgD,CACnDuB,EAAE,CAAG,KAAK5C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAAL,CACAwB,EAAE,CAAG,CAAL,CACH,CAHM,IAGA,IAAID,EAAE,EAAIA,EAAE,GAAK,KAAK5C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAAjB,CAAmC,CACtCwB,EAAE,CAAG,KAAK7C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAAL,CACH,CAFM,IAEA,CACHuB,EAAE,CAAG,KAAK5C,KAAL,CAAWoB,EAAX,EAAcC,EAAd,CAAL,CACH,CACJ,CACJ,CACJ,C,iDAEa,CACV,KAAKc,eAAL,GACH,C,qCAEO,CACJ,IAAK,GAAIf,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,CAApB,CAAuBA,CAAC,EAAxB,CAA4B,CACxB,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,CAApB,CAAuBA,CAAC,EAAxB,CAA4B,CAChC,KAAKnC,OAAL,CAAagE,SAAb,6BACM5B,IAAI,CAACC,KAAL,CAAW,IAAM,KAAOH,CAAxB,CADN,2BAEME,IAAI,CAACC,KAAL,CAAW,IAAM,KAAOF,CAAxB,CAFN,sBAIA,KAAKnC,OAAL,CAAaiE,QAAb,CAAsB,CAAtB,CAAwB,CAAxB,CAA2B,KAAKpE,MAAL,CAAYK,KAAvC,CAA8C,KAAKL,MAAL,CAAYM,MAA1D,EACK,CACJ,CACJ,C,uCAEQ,iBACL,KAAK+D,KAAL,GAAc;AACd;AACA,IAAK,GAAIhC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKpB,KAAL,CAAWqD,MAA/B,CAAuCjC,CAAC,EAAxC,CAA4C,CACxC,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKrB,KAAL,CAAWqD,MAA/B,CAAuChC,CAAC,EAAxC,CAA4C,CACxC,GAAI,KAAKrB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAJ,CAAsB,CAClB,GAAI,KAAKX,KAAL,GAAeU,CAAf,EAAoB,KAAKT,KAAL,GAAeU,CAAvC,CAA0C,CACtC,SACH,CACD,KAAKnC,OAAL,CAAamD,SAAb,CAAuB,KAAKpB,KAAL,CAAW,KAAKjB,KAAL,CAAWoB,CAAX,EAAcC,CAAd,CAAX,CAAvB,CAAqDD,CAAC,CAAG,KAAKrB,IAA9D,CAAoEsB,CAAC,CAAG,KAAKtB,IAA7E,CAAmF,KAAKA,IAAxF,CAA8F,KAAKA,IAAnG,EACH,CALD,IAKO,CACH,KAAKb,OAAL,CAAaiE,QAAb,CAAsB/B,CAAC,CAAG,KAAKrB,IAA/B,CAAqCsB,CAAC,CAAG,KAAKtB,IAA9C,CAAoD,KAAKA,IAAzD,CAA+D,KAAKA,IAApE,EACH,CACJ,CACJ,CAED;AACA,GAAIuD,CAAAA,OAAO,CAAG,KAAd,CACA,IAAK,GAAIlC,CAAAA,GAAC,CAAG,KAAKR,KAAL,CAAWyC,MAAX,CAAoB,CAAjC,CAAoCjC,GAAC,EAAI,CAAzC,CAA4CA,GAAC,EAA7C,CAAiD,CAC7C,GAAMmC,CAAAA,IAAI,CAAG,KAAK3C,KAAL,CAAWQ,GAAX,CAAb,CACA,GAAImC,IAAJ,CAAU,CACNA,IAAI,CAACT,YAAL,GACA,GAAIS,IAAI,CAACT,YAAL,EAAqB,KAAKjC,UAAL,CAAgBwC,MAAzC,CAAiD,CAC7C,KAAKzC,KAAL,CAAW4C,MAAX,CAAkBpC,GAAlB,CAAqB,CAArB,EACH,CAFD,IAEO,CACH,GAAMA,CAAAA,GAAC,CAAGmC,IAAI,CAACnC,CAAf,CACA,GAAMC,CAAAA,GAAC,CAAGkC,IAAI,CAAClC,CAAf,CACA,KAAKnC,OAAL,CAAamD,SAAb,CAAuB,KAAKxB,UAAL,CAAgB0C,IAAI,CAACT,YAArB,CAAvB,CAA2D1B,GAAC,CAAG,KAAKrB,IAApE,CAA0EsB,GAAC,CAAG,KAAKtB,IAAnF,CAAyF,KAAKA,IAA9F,CAAoG,KAAKA,IAAzG,EACAuD,OAAO,CAAG,IAAV,CACH,CACJ,CACJ,CAED,GAAIA,OAAJ,CAAa,CACTP,UAAU,CAAC,iBAAM,CAAA,MAAI,CAAC5B,MAAL,EAAN,EAAD,CAAsB,GAAtB,CAAV,CACH,CACJ,C,0BAGL,cAAevC,CAAAA,UAAf","sourcesContent":["class GameDrPill {\r\n    constructor({ id, callbacks }) {\r\n        this.canvas = document.getElementById(id);\r\n        this.context = this.canvas.getContext('2d');\r\n        this.canvas.width = 560;\r\n        this.canvas.height = 560;\r\n        this.canvas.addEventListener('click', (event) => this.clickCell(event));\r\n        this.canvas.addEventListener('mousemove', (event) => this.moveCell(event));\r\n        this.canvas.addEventListener('mouseup', () => this.upCell());\r\n        this.canvas.addEventListener('mousedown', (event) => this.downCell(event));\r\n\r\n        this.ADD_PILLS = 10;\r\n        this.FIELD_SIZE = 8;\r\n        this.ROUND_TIME = 60; // sec\r\n        this.SIZE = 70;\r\n\r\n        this.callbacks = callbacks;\r\n\r\n        this.field = [];\r\n        this.sec = 0;\r\n        this.interval = null;\r\n        this.currentPills = 0;\r\n        this.requirePills = 20;\r\n        this.vaccineScore = 0;\r\n        this.firstStep = true;\r\n        this.x = -1;\r\n        this.y = -1;\r\n        this.isDrug = null;\r\n        this.drugX = -1;\r\n        this.drugY = -1;\r\n\r\n        this.booms = [];\r\n        this.boomImages = [];\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[0].src = '/img/1.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[1].src = '/img/2.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[2].src = '/img/3.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[3].src = '/img/4.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[4].src = '/img/5.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[5].src = '/img/6.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[6].src = '/img/7.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[7].src = '/img/8.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[8].src = '/img/9.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[9].src = '/img/10.png';\r\n        this.boomImages.push(new Image());\r\n        this.boomImages[10].src = '/img/11.png';\r\n\r\n        this.pills = [null];\r\n        this.pills.push(new Image());\r\n        this.pills[1].src = '/img/pill_1.png';\r\n        this.pills[1].onload = () => {\r\n            this.pills.push(new Image());\r\n            this.pills[2].src = '/img/pill_2.png';\r\n            this.pills[2].onload = () => {\r\n                this.pills.push(new Image());\r\n                this.pills[3].src = '/img/pill_5.png';\r\n                this.pills[3].onload = () => {\r\n                    this.pills.push(new Image());\r\n                    this.pills[4].src = '/img/pill_8.png';\r\n                    this.pills[4].onload = () => {\r\n                        this.pills.push(new Image());\r\n                        this.pills[5].src = '/img/pill_10.png';\r\n                        this.pills[5].onload = () => this.render();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            this.field.push([]);\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                this.field[i][j] = 1 + Math.floor(Math.random() * 5);\r\n            }\r\n        }\r\n    }\r\n\r\n    startTimeUpdate() {\r\n        if (this.interval) {\r\n            this.sec = 0;\r\n            clearInterval(this.interval);\r\n        }\r\n        this.interval = setInterval(() => {\r\n            this.sec++;\r\n            if (this.sec >= this.ROUND_TIME) { // закончить игру\r\n                clearInterval(this.interval);\r\n                this.callbacks.endGame(this.vaccineScore);\r\n                return;\r\n            }\r\n            this.callbacks.timeTick(this.ROUND_TIME - this.sec);\r\n        }, 1000);\r\n    }\r\n\r\n    move(i1, j1, i2, j2) {\r\n        if ((i1 === i2 && Math.abs(j1 - j2) === 1) ||\r\n            (Math.abs(i1 - i2) === 1 && j1 === j2)) {\r\n            let c = this.field[i1][j1];\r\n            this.field[i1][j1] = this.field[i2][j2];\r\n            this.field[i2][j2] = c;\r\n            if (this.firstStep) { // старт счетчика времени\r\n                this.firstStep = false;\r\n                this.startTimeUpdate();\r\n            }\r\n            this.render();\r\n            this.getStatus();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    moveCell(event) {\r\n        if (this.isDrug) {\r\n            if (this.drugX >= 0 && this.drugY >= 0) {\r\n                this.render();\r\n                if (this.field[this.drugX][this.drugY]) {\r\n                    this.context.drawImage(\r\n                        this.pills[this.field[this.drugX][this.drugY]],\r\n                        event.offsetX - this.SIZE / 2,\r\n                        event.offsetY - this.SIZE / 2,\r\n                        this.SIZE,\r\n                        this.SIZE\r\n                    );\r\n                    let x = Math.floor(event.offsetX / this.SIZE);\r\n                    let y = Math.floor(event.offsetY / this.SIZE);\r\n                    if (Math.abs((x + y) - (this.drugX + this.drugY)) === 1) {\r\n                        this.move(this.drugX, this.drugY, x, y);\r\n                        this.upCell();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    upCell() {\r\n        this.isDrug = false;\r\n        this.drugX = -1;\r\n        this.drugY = -1;\r\n    }\r\n\r\n    downCell(event) {\r\n        this.isDrug = true;\r\n        this.drugX = Math.floor(event.offsetX / this.SIZE);\r\n        this.drugY = Math.floor(event.offsetY / this.SIZE);\r\n    }\r\n\r\n    clickCell(event) {\r\n        if (this.x >= 0 && this.y >= 0) {\r\n            let x = Math.floor(event.offsetX / this.SIZE);\r\n            let y = Math.floor(event.offsetY / this.SIZE);\r\n            this.move(this.x, this.y, x, y);\r\n            this.x = -1;\r\n            this.y = -1;\r\n        } else {\r\n            this.x = Math.floor(event.offsetX / this.SIZE);\r\n            this.y = Math.floor(event.offsetY / this.SIZE);\r\n        }\r\n    }\r\n\r\n    dropOneCell(i, j) {\r\n        if (j === 0) {\r\n            this.field[i][j] = 1 + Math.floor(Math.random() * 5);\r\n        } else {\r\n            for (let k = j; k >= 0; k--) {\r\n                if (this.field[i][k - 1] !== undefined) {\r\n                    this.field[i][k] = this.field[i][k - 1];\r\n                    this.field[i][k - 1] = 0;\r\n                } else {\r\n                    this.field[i][k] = 1 + Math.floor(Math.random() * 5)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    dropElements() {\r\n        for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n            for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n                if (this.field[i][j] === 0) {\r\n                    this.dropOneCell(i, j);\r\n                    this.render();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getStatus() {\r\n        let a1 = 0;\r\n        let a2 = 0;\r\n        // пробежаться по столбцам\r\n        for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n            a1 = 0;\r\n            a2 = 0;\r\n            for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n                if (a1 && a1 === a2 && a2 === this.field[i][j]) {\r\n                    this.field[i][j] = 0;\r\n                    this.field[i][j - 1] = 0;\r\n                    this.field[i][j - 2] = 0;\r\n                    this.booms.push({ i, j, currentImage: -1 });\r\n                    this.booms.push({ i, j: j - 1, currentImage: -1 });\r\n                    this.booms.push({ i, j: j - 2, currentImage: -1 });\r\n                    setTimeout(() => this.dropElements(), 1500);\r\n                    this.render();\r\n                    this.callbacks.addPills(3);\r\n                } else if (a1 && a1 === a2 && a2 !== this.field[i][j]) {\r\n                    a1 = this.field[i][j];\r\n                    a2 = 0;\r\n                } else if (a1 && a1 === this.field[i][j]) {\r\n                    a2 = this.field[i][j];\r\n                } else {\r\n                    a1 = this.field[i][j];\r\n                }\r\n            }\r\n        }\r\n        // пробежаться по строки\r\n        for (let j = 0; j < this.FIELD_SIZE; j++) {\r\n            a1 = 0;\r\n            a2 = 0;\r\n            for (let i = 0; i < this.FIELD_SIZE; i++) {\r\n                if (a1 && a1 === a2 && a2 === this.field[i][j]) {\r\n                    this.field[i][j] = 0;\r\n                    this.field[i - 1][j] = 0;\r\n                    this.field[i - 2][j] = 0;\r\n                    this.booms.push({ i, j, currentImage: -1 });\r\n                    this.booms.push({ i: i - 1, j, currentImage: -1 });\r\n                    this.booms.push({ i: i - 2, j, currentImage: -1 });\r\n                    setTimeout(() => this.dropElements(), 1500);\r\n                    this.render();\r\n                    this.callbacks.addPills(3);\r\n                } else if (a1 && a1 === a2 && a2 !== this.field[i][j]) {\r\n                    a1 = this.field[i][j];\r\n                    a2 = 0;\r\n                } else if (a1 && a1 === this.field[i][j]) {\r\n                    a2 = this.field[i][j];\r\n                } else {\r\n                    a1 = this.field[i][j];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    restartTime() {\r\n        this.startTimeUpdate();\r\n    }\r\n\r\n    clear() {\r\n        for (let i = 0; i < 6; i++) {\r\n            for (let j = 0; j < 6; j++) {\r\n        this.context.fillStyle = `rgb(\r\n            ${Math.floor(255 - 42.5 * i)},\r\n            ${Math.floor(255 - 42.5 * j)},\r\n            0)`;\r\n        this.context.fillRect(0,0, this.canvas.width, this.canvas.height);\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        this.clear(); // очистка\r\n        // нарисовать пилюльки\r\n        for (let i = 0; i < this.field.length; i++) {\r\n            for (let j = 0; j < this.field.length; j++) {\r\n                if (this.field[i][j]) {\r\n                    if (this.drugX === i && this.drugY === j) {\r\n                        continue;\r\n                    }\r\n                    this.context.drawImage(this.pills[this.field[i][j]], i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE);\r\n                } else {\r\n                    this.context.fillRect(i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE)\r\n                }\r\n            }\r\n        }\r\n\r\n        // нарисовать бумсы\r\n        let refresh = false;\r\n        for (let i = this.booms.length - 1; i >= 0; i--) {\r\n            const boom = this.booms[i];\r\n            if (boom) {\r\n                boom.currentImage++;\r\n                if (boom.currentImage >= this.boomImages.length) {\r\n                    this.booms.splice(i, 1);\r\n                } else {\r\n                    const i = boom.i;\r\n                    const j = boom.j;\r\n                    this.context.drawImage(this.boomImages[boom.currentImage], i * this.SIZE, j * this.SIZE, this.SIZE, this.SIZE);\r\n                    refresh = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (refresh) {\r\n            setTimeout(() => this.render(), 125);\r\n        }\r\n    }\r\n}\r\n\r\nexport default GameDrPill;"]},"metadata":{},"sourceType":"module"}